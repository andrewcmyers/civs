<!DOCTYPE HTML>
<html lang="en-us">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Condorcet Internet Voting Service</title>
<link rel="stylesheet" type="text/css" href="@CIVSURL@/style.css" />
<link rel="canonical" href="@CIVSURL@/civs_create.html">
<link href="@CIVSURL@/images/check123b.png" rel="shortcut icon">
<script>
    function trim(str) {
        return str.replace(/^\s+|\s+$/g, '')
    }
    function validateEmail(str)   // element to be validated
    {
        var str = trim(str);  // value of field with whitespace trimmed off
        var email = /^[^@]+@[^@.]+\.[^@]*\w\w$/
        return email.test(str);
    }

    function validate() {
        var numerrs = 0;
        var errs = new Array;
        if (!validateEmail(document.forms.CreateElection.email_addr.value)) {
            errs[numerrs++] = 'Supervisor email address is invalid.';
        }
        if (!(document.forms.CreateElection.num_winners.value >= 1)) {
            errs[numerrs++] = 'Must have at least one winner.';
        }
        if (document.forms.CreateElection.proportional.checked &&
            !(document.forms.CreateElection.num_winners.value > 1)) {
            errs[numerrs++] =
                'Proportional representation requires more than one winner.';
        }
        if (document.forms.CreateElection.choices.value == '' &&
            document.forms.CreateElection.choices_file.value == '') {
            errs[numerrs++] = 'Must have at least two choices to vote on.';
        }
        if (document.forms.CreateElection.restrict_results.checked) {
            var rs = document.forms.CreateElection.result_addrs.value;
            var ra = rs.split(/[\r\n]+/g);
            var nr = 0;
            for (i = 0; i < ra.length; i++) {
                if (ra[i] == '') continue;
                if (!validateEmail(ra[i])) {
                    errs[numerrs++] =
                        'Results recipient email address is invalid: ' + ra[i];
                } else {
                    nr++;
                }
            }
            if (nr == 0) {
                errs[numerrs++] =
                    'You have specified no users who can see the poll results.';
            }
        }
        if (numerrs == 0) return true;
        if (numerrs == 1) {
            alert(errs[0]);
        } else {
            var msg = 'Errors:\n';
            for (i = 0; i < numerrs; i++) {
                msg += (i+1);
                msg += '. ';
                msg += errs[i];
                msg += "\n";
            }
            alert(msg);
        }
        return false;
    }

    function render_text(prefix, ta_id, span_id, clss) {
        var span = document.getElementById(span_id);
        var ta = document.getElementById(ta_id);
        span.innerHTML = prefix + '<div class="' + clss + '">' + ta.value + "</div>";
        return 1;
    }

    function render_list(ta_id, span_id) {
        var span = document.getElementById(span_id);
        var ta = document.getElementById(ta_id);
        var names = ta.value.split(/[\r\n]+/g);
        var html = "";
        for (i = 0; i < names.length; i++) {
            if (names[i] != "")
                html = html + "<li>" + names[i] + "</li>";
        }
        span.innerHTML = "<ul>" + html + "</ul>";
        return 1;
    }

    function make_invisible(id) {
        document.getElementById(id).style.display = 'none'
    }
    function make_visible(id) {
        document.getElementById(id).style.display = 'block'
    }
    function preview_description() {
        render_text('<h2>Poll description</h2>',
                    'description',
                    'rendered_description',
                    'description')
    }
    function preview_choices() {
        render_list('choices', 'rendered_choices')
    }
</script>
<script src="ezdom.js"></script>
<script src="civs_hdr.js"></script>

</head>

<body>

<script>
var body = document.getElementsByTagName('body')[0]
body.appendChild(create_header("Erstellen Sie eine Umfrage", "de"))
</script>

<div class="contents">

<form method="POST"
    action="@CIVSBINURL@/create_election@PERLEXT@"
    enctype="multipart/form-data"
    accept-charset="UTF-8"
    name="CreateElection"
    onsubmit="return validate()">
  <table class="form">
  <tr>
    <td class="label"><label id="name_of_poll">Name der Umfrage (z. B. <b>The Democratic Primary</b>):</label></td>
    <td><input type="text" title="Poll name" name="title" size="50" aria-labelledby="name_of_poll"></td>
  <tr>
    <td class="label"><label id="supervisor_name">Name des Betreuers (Sie):</label></td>
    <td><input type="text" name="name" size="20" aria-labelledby="supervisor_name">
  </td>
  <tr>
    <td class="label"><label id="supervisor_email">E-Mail-Adresse des Betreuers:</label></td>
    <td><input type="text" name="email_addr" size="20" aria-labelledby="supervisor_email"
      onchange="if (!validateEmail(this.value)) { alert('Invalid email address') }" >
    </td>
  </tr>
  <tr>
    <td class="label"><label id="election_end_label">Tag und Uhrzeit, zu der Sie die Umfrage beenden möchten:</label><br>
        <small>(<b>Hinweis:</b> Umfragen müssen manuell gestoppt werden)</small>
    </td>
    <td><input type="text" name="election_end" id="election_end" size="30"
               aria-labelledby="election_end_label"
          onchange="render_text('<br><i>Vorschau</i>: Poll ends ', 'election_end', 'rendered_end', 'poll_end', 'poll_end_preview')">
         <span class="rendering" id="rendered_end"></span>
</td>
  </tr>
  </table>

<div class="emphasized">
Ihr Name und Ihre E-Mail-Adresse werden verwendet, wenn Sie eine E-Mail an senden
   Wähler. Ihr Name sollte für die Wähler und die E-Mail erkennbar sein
   Adresse muss funktionieren, da CIVS Ihnen die dazu benötigten Informationen per E-Mail zuschickt
   kontrolliert die Umfrage. Stellen Sie sicher, dass Ihr Spamfilter dies nicht tut
   blockieren Sie E-Mails von <kbd>@SUPERVISOR@</kbd> (oder überprüfen Sie Ihren Spam-Ordner, falls
   die Post kommt nicht an!).
  </div>

  <p><label id="description_label">Beschreibung der Umfrage und verfügbare Auswahlmöglichkeiten (viele HTML-Tags ok):</label><br>
  <table class="form">
    <tr>
      <td><textarea id="description" rows="5" name="description" cols="60"
                    aria-labelledby="description_label"
                    onchange="preview_description()"></textarea>
      </td>
      <td><input type="button" value="Vorschau &#9656;"
            onClick="preview_description()">
      <td><span class="rendering" id="rendered_description"></span></td>
    </tr>
  </table>

  <p><label id="choices_label">Geben Sie die Namen aller Auswahlmöglichkeiten (Kandidaten) ein,
      eine pro Zeile, oder laden Sie eine Datei hoch, die alle Auswahlmöglichkeiten enthält:</label></p>
  <table class="form">
  <tr><td>
    <textarea rows="5" name="choices" cols="60" id="choices"
        aria-labelledby="choices_label"
        onchange="preview_choices()"></textarea></td>
    <td>
      <td><input type="button" value="Vorschau &#9656;"
            onClick="preview_choices()"></td>
      <td><span class="rendering" id="rendered_choices"></span></td>
    </tr>
  </table>
  <p><input type=file aria-labelledby="choices_label" name="choices_file" id="choices_file"></p>

  <p><label id="num_winners_label">Wie viele Entscheidungen gewinnen:</label>
     <input type="text" name="num_winners" size="5" value="1" aria-labelledby="num_winners_label"></p>
<!--
<p>The e-mail addresses of up to 1000 voters, one per line.
Voters can also be added later.</p>
<p><textarea rows="2" name="addresses" cols="50"></textarea></p>
<p><input type=file name="addresses_file"></p>
-->
  <p><label id="public_or_private">Soll die Umfrage <em>privat</em> oder <em>öffentlich</em> sein?</label></p>
  <div id="pubpriv_choice">
  <fieldset>
  <div class="pubpriv">
  <input type="radio" name="public" value="no" checked="checked" aria-labelledby="public_or_private">
  <strong>Privat</strong>
  <p>Jeder Wähler erhält seine eigene eindeutige URL zum Abstimmen und kann nur einmal abstimmen.
      Dazu müssen die E-Mail-Adressen der Wähler dem System zur Verfügung gestellt werden
      Sagen Sie ihnen ihre Abstimmungs-URL, aber das System vergisst ihre Adressen
      unmittelbar nach Versand der E-Mail. Sie können nach der Umfrage Wähler hinzufügen
      erstellt worden.
  </p>
  </div>
  <div class="pubpriv">
  <input type="radio" name="public" value="yes" aria-labelledby="public_or_private"
      onClick="make_visible('publicize')">

  <strong>Öffentlich</strong>
  <p>
  Es gibt eine einzige URL, die jeder Wähler verwenden kann, um seine Stimme abzugeben, und das ist sie
     Ihre Aufgabe, es zu verteilen. Es gibt jedoch nur einen symbolischen Versuch
     Verhindern Sie Mehrfachabstimmungen, basierend auf den IP-Adressen der Wähler. Wenn Sie machen möchten
     Stellen Sie sicher, dass die Wähler nur einmal abstimmen, verwenden Sie stattdessen eine private Umfrage.
  </p>
  </div>
  </fieldset>
  </div>

  <h3>Weitere Optionen <small>(bewegen Sie die Maus über jedes Kontrollkästchen, um weitere Informationen zu erhalten)</small></h3>
    <div class="option" id="publicize">
    <input type="checkbox" name="publicize" value="yes"
      title="CIVS will announce this poll on its list of public polls and possibly elsewhere.  Anyone who views the list will be able to vote."
      onclick="make_invisible('restrict_results_div'); make_invisible('reveal_voters_div')">
    Lassen Sie CIVS diese Wahl auf seiner Homepage veröffentlichen.
    </div>
    <div>
  <input type="checkbox" name="external_ballots" value="yes"
      title="If you want to upload all the voting ballots yourself, check this box. Voters cannot vote in such a poll. This is useful if you are trying to understand how the various voting methods work, or if you have obtained ballots from some source outside CIVS.">
    Machen Sie dies zu einer Testumfrage: Lesen Sie alle Stimmen aus einer Datei.
</div>
<div id='restrict_results_div'>
  <input type="checkbox" id="restrict_results" name="restrict_results" value="yes"
         title="Restrict results" onClick="make_visible('rrcontrol')">
    Geben Sie die Ergebnisse nicht an alle Wähler weiter.
     <div class="emphasized">Standardmäßig sind die Ergebnisse einer Umfrage für sichtbar
     alle Wähler. Wählen Sie diese Option, um die Sichtbarkeit auf einige kleinere zu beschränken
     Gruppe von Menschen.
     </div>
    <div class="suboption" id="rrcontrol">
    <label id="result_addrs_label">
    Geben Sie E-Mail-Adressen von Benutzern ein, die berechtigt sind, Umfrageergebnisse anzuzeigen:
     (Alle Wähler können diese E-Mail-Adressen sehen)
    </label>
    <br>
    <textarea rows="2" aria-labelledby="result_addrs_label" name="result_addrs" cols="50"></textarea>
    </div>
</div>
<div id='reveal_voters_div'>
  <input type="checkbox" name="ballot_reporting" value="yes"
         onClick="make_visible('reveal_voters')"
         title="Diese Option ermöglicht es jedem Umfrageteilnehmer, die Rangliste für jeden Stimmzettel anzuzeigen. Identifizierende Informationen über die Wähler, die diese Stimmzettel abgegeben haben, werden jedoch nicht offengelegt, es sei denn, die nächste Option wird aktiviert.">
  Enable detailed ballot reporting.
  <div class="suboption" id="reveal_voters">
    <input type="checkbox" name="reveal_voters" value="yes" aria-labelledby="reveal_voters_label"/>
    <label id="reveal_voters_label">
     Geben Sie im ausführlichen Wahlbericht auch die Identität des jeweiligen Wählers an
     Stimmzettel.</label><p class=emphasized>Wähler sind <i class="warning">nicht</i> anonym, wenn dies der Fall ist
     überprüft, und der Server verwirft auch nicht die E-Mail-Adressen der Wähler wie normalerweise
     tut. Die Wähler werden vor dieser fehlenden Anonymität gewarnt. Mehrere Stimmen von a
     einzelne IP-Adressen sind erlaubt, wenn es sich um eine öffentliche Umfrage handelt.
     </p>
  </div>
</div>
<div>
  <input type="checkbox" name="writeins" value="yes"
   title="Mit dieser Option können Sie Einschreibungen zulassen. Einschreibungen sind jedoch stark im Nachteil, wenn sie nach der Stimmabgabe erfolgen. Daher gibt es bei Auswahl dieser Option eine Einschreibephase, in der keine Stimmzettel abgegeben werden können. Der Vorgesetzte muss das Voting explizit freigeben.">
  Ermöglichen Sie den Wählern, neue Wahlmöglichkeiten einzutragen.
</div>
<div>
  <input type="checkbox" name="shuffle" value="no"
  title="Standardmäßig werden Wahlmöglichkeiten auf jedem Stimmzettel in einer zufällig gemischten Reihenfolge angezeigt. Bei einigen Umfragen, wie z. B. der Wahl einer Besprechungszeit, ist es für die Wähler bequemer, die Auswahlmöglichkeiten in genau der oben angegebenen Reihenfolge zu sehen.">
  Präsentieren Sie die Auswahlmöglichkeiten auf der Abstimmungsseite in genau der angegebenen Reihenfolge.
</div>
<div>
  <input type="checkbox" name="no_opinion" value="yes"
    title="Die &#x22;keine Meinung&#x22; Option kann unerwartete Auswirkungen haben. Lesen Sie unbedingt die FAQ zur Verwendung und informieren Sie die Wähler entsprechend.">
Wählen Sie &bdquo;keine Meinung&rdquo; für einige Auswahlmöglichkeiten.<br>
  <input type="checkbox" name="proportional" value="yes"
         onClick="make_visible('prcontrol')"
         title="Der proportionale Modus ist nur für Multiwinner-Wahlen sinnvoll, bei denen Sie sicherstellen möchten, dass die Wünsche der Wähler proportional ausgedrückt werden. Andernfalls kann eine Mehrheit der Wähler alle Gewinner bestimmen. Der proportionale Modus ist viel langsamer als der normale nicht-proportionale Modus und sollte nicht in Fällen verwendet werden, in denen es viele Auswahlmöglichkeiten und viele Gewinner gibt. In den meisten Fällen, aber nicht in allen Fällen, stimmen die Ergebnisse aus dem proportionalen und dem nicht-proportionalen Modus überein. Klicken Sie auf den Link „Weitere Informationen“, um mehr über die Funktionsweise dieses Modus zu erfahren.">
Verhältniswahl durchsetzen [<a href="proportional.html">weitere Informationen</a>]
   <div class="suboption" id="prcontrol">
   <label id="prcontrol_label">
Bei der Verhältniswahl wird angenommen, dass die Wähler maximieren:
    <input type="radio" name="rating_interpretation"
       value="best_choice" aria-labelledby="prcontrol_label"
       checked> Rang ihrer Lieblingswahl<br>
    <input type="radio" name="rating_interpretation" aria-labelledby="prcontrol_label"
       value="combined_ratings"> kombinierte Gewichte ausgewählter Optionen<br>
   </div>
</div>

<br><div class="emphasized">
Stellen Sie sicher, dass Ihre E-Mail-Adresse korrekt ist, da die Umfrageinformationen dies tun
   per E-Mail an Sie gesendet werden. Die Wähler werden nicht über die Umfrage informiert
   bestehen, bis Sie auf diese E-Mail-Nachricht antworten.
  </div>
  <p style="margin-left: 5ex">
    <input type="submit" value="Umfrage erstellen" name="submit">
  </p>
</form>
</div>

<script>
    make_invisible('publicize');
    make_invisible('prcontrol');
    make_invisible('reveal_voters');
    make_invisible('rrcontrol');
</script>
</body>

</html>
